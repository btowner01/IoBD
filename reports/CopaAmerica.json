{"paragraphs":[{"title":"Load data into table","text":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\n\n// Zeppelin creates and injects sc (SparkContext) and sqlContext (HiveContext or SqlContext)\n// So you don't need create them manually\n\nval copaText = sc.parallelize(\n    IOUtils.toString(\n        new URL(\"https://s3.amazonaws.com/bdt-iobd-blog/copa-america-historical/copa_america_historical_data_validated.csv\"),\n        Charset.forName(\"utf8\")).split(\"\\n\"))\n\ncase class Copa(\n    Country_Name:String,\n    Country_Code:String,\n    Series_Code:String,\n    YR1990: Float,\n    YR2000: Float,\n    YR2006: Float,\n    YR2007: Float,\n    YR2008: Float,\n    YR2009: Float,\n    YR2010: Float,\n    YR2011: Float,\n    YR2012: Float,\n    YR2013: Float,\n    YR2014: Float,\n    YR2015: Float)\n\nval myCopa = copaText.map(s=>s.split(\",\")).filter(s=>s(0)!=\"Country_Name\").map(\n  s=>Copa(s(0), \n          s(1),\n          s(2),\n          s(3).toFloat,\n          s(4).toFloat,\n          s(5).toFloat,\n          s(6).toFloat,\n          s(7).toFloat,\n          s(8).toFloat,\n          s(9).toFloat,\n          s(10).toFloat,\n          s(11).toFloat,\n          s(12).toFloat,\n          s(13).toFloat,\n          s(14).toFloat\n      )\n ).toDF()\nmyCopa.registerTempTable(\"myCopa\")\n ","dateUpdated":"Jun 26, 2016 5:45:00 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"title":true,"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466961815928_1079542783","id":"20160626-172335_1498215965","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.commons.io.IOUtils\nimport java.net.URL\nimport java.nio.charset.Charset\ncopaText: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[76] at parallelize at <console>:44\ndefined class Copa\nmyCopa: org.apache.spark.sql.DataFrame = [Country_Name: string, Country_Code: string, Series_Code: string, YR1990: float, YR2000: float, YR2006: float, YR2007: float, YR2008: float, YR2009: float, YR2010: float, YR2011: float, YR2012: float, YR2013: float, YR2014: float, YR2015: float]\n"},"dateCreated":"Jun 26, 2016 5:23:35 PM","dateStarted":"Jun 26, 2016 5:45:00 PM","dateFinished":"Jun 26, 2016 5:45:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:563"},{"text":"%md\n## Let's use Spark with Zeppelin here.\n##### Begin with a simple Spark integration of Databank Data. (Shift-Enter to Run)\nThere are 3 main variables specific to the countries that I focused on aggregated over the past 5 years.\n  1. Overall GDP  \n  2. Primary completion rate, ratio to the last grade of primary education  \n  3. Mobile cellular subscriptions (per 100 people)  ","dateUpdated":"Jun 26, 2016 5:57:34 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorHide":true,"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466961815926_1081851276","id":"20160626-172335_1410940226","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Let's use Spark with Zeppelin here.</h2>\n<h5>Begin with a simple Spark integration of Databank Data. (Shift-Enter to Run)</h5>\n<p>There are 3 main variables specific to the countries that I focused on aggregated over the past 5 years.</p>\n<ol>\n<li>Overall GDP</li>\n<li>Primary completion rate, ratio to the last grade of primary education</li>\n<li>Mobile cellular subscriptions (per 100 people)</li>\n</ol>\n"},"dateCreated":"Jun 26, 2016 5:23:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20","dateFinished":"Jun 26, 2016 5:57:32 PM","dateStarted":"Jun 26, 2016 5:57:32 PM","focus":true},{"text":"%sql \nselect Country_Name,YR2010, YR2011, YR2012, YR2013, YR2014, YR2015\nfrom myCopa\nwhere Series_Code = \"${Series_Code=NY-GDP-MKTP-CD}\"\n\n","dateUpdated":"Jun 26, 2016 5:54:52 PM","config":{"colWidth":4,"graph":{"mode":"pieChart","height":376,"optionOpen":false,"keys":[{"name":"Country_Name","index":0,"aggr":"sum"}],"values":[{"name":"YR2010","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Country_Name","index":0,"aggr":"sum"},"yAxis":{"name":"YR2010","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{"Series_Code":"NY-GDP-MKTP-CD"},"forms":{"Series_Code":{"name":"Series_Code","defaultValue":"NY-GDP-MKTP-CD","hidden":false}}},"jobName":"paragraph_1466961815928_1079542783","id":"20160626-172335_2043475913","result":{"code":"SUCCESS","type":"TABLE","msg":"Country_Name\tYR2010\tYR2011\tYR2012\tYR2013\tYR2014\tYR2015\nUnited States\t1.50000003E13\t1.55000001E13\t1.62000001E13\t1.68000005E13\t1.73999999E13\t0.0\nArgentina\t4.61999997E11\t5.5799998E11\t6.0400003E11\t6.1399997E11\t5.37999999E11\t0.0\nEcuador\t6.9555364E10\t7.9276663E10\t8.7924548E10\t9.4776173E10\t1.01000004E11\t0.0\nVenezuela- RB\t3.94000007E11\t3.1600001E11\t3.80999991E11\t0.0\t0.0\t0.0\nPeru\t1.48999995E11\t1.71000005E11\t1.92999997E11\t2.02000007E11\t2.03000005E11\t0.0\nColombia\t2.87000003E11\t3.35000011E11\t3.70000003E11\t3.8000001E11\t3.78000015E11\t0.0\nMexico\t1.05000003E12\t1.17000005E12\t1.18000006E12\t1.25999999E12\t1.29000001E12\t0.0\nChile\t2.17999999E11\t2.50999996E11\t2.64999993E11\t2.76999995E11\t2.57999995E11\t0.0\n","comment":"","msgTable":[[{"key":"YR2010","value":"United States"},{"key":"YR2010","value":"1.50000003E13"},{"key":"YR2010","value":"1.55000001E13"},{"key":"YR2010","value":"1.62000001E13"},{"key":"YR2010","value":"1.68000005E13"},{"key":"YR2010","value":"1.73999999E13"},{"key":"YR2010","value":"0.0"}],[{"key":"YR2011","value":"Argentina"},{"key":"YR2011","value":"4.61999997E11"},{"key":"YR2011","value":"5.5799998E11"},{"key":"YR2011","value":"6.0400003E11"},{"key":"YR2011","value":"6.1399997E11"},{"key":"YR2011","value":"5.37999999E11"},{"key":"YR2011","value":"0.0"}],[{"key":"YR2012","value":"Ecuador"},{"key":"YR2012","value":"6.9555364E10"},{"key":"YR2012","value":"7.9276663E10"},{"key":"YR2012","value":"8.7924548E10"},{"key":"YR2012","value":"9.4776173E10"},{"key":"YR2012","value":"1.01000004E11"},{"key":"YR2012","value":"0.0"}],[{"key":"YR2013","value":"Venezuela- RB"},{"key":"YR2013","value":"3.94000007E11"},{"key":"YR2013","value":"3.1600001E11"},{"key":"YR2013","value":"3.80999991E11"},{"key":"YR2013","value":"0.0"},{"key":"YR2013","value":"0.0"},{"key":"YR2013","value":"0.0"}],[{"key":"YR2014","value":"Peru"},{"key":"YR2014","value":"1.48999995E11"},{"key":"YR2014","value":"1.71000005E11"},{"key":"YR2014","value":"1.92999997E11"},{"key":"YR2014","value":"2.02000007E11"},{"key":"YR2014","value":"2.03000005E11"},{"key":"YR2014","value":"0.0"}],[{"key":"YR2015","value":"Colombia"},{"key":"YR2015","value":"2.87000003E11"},{"key":"YR2015","value":"3.35000011E11"},{"key":"YR2015","value":"3.70000003E11"},{"key":"YR2015","value":"3.8000001E11"},{"key":"YR2015","value":"3.78000015E11"},{"key":"YR2015","value":"0.0"}],[{"value":"Mexico"},{"value":"1.05000003E12"},{"value":"1.17000005E12"},{"value":"1.18000006E12"},{"value":"1.25999999E12"},{"value":"1.29000001E12"},{"value":"0.0"}],[{"value":"Chile"},{"value":"2.17999999E11"},{"value":"2.50999996E11"},{"value":"2.64999993E11"},{"value":"2.76999995E11"},{"value":"2.57999995E11"},{"value":"0.0"}]],"columnNames":[{"name":"Country_Name","index":0,"aggr":"sum"},{"name":"YR2010","index":1,"aggr":"sum"},{"name":"YR2011","index":2,"aggr":"sum"},{"name":"YR2012","index":3,"aggr":"sum"},{"name":"YR2013","index":4,"aggr":"sum"},{"name":"YR2014","index":5,"aggr":"sum"},{"name":"YR2015","index":6,"aggr":"sum"}],"rows":[["United States","1.50000003E13","1.55000001E13","1.62000001E13","1.68000005E13","1.73999999E13","0.0"],["Argentina","4.61999997E11","5.5799998E11","6.0400003E11","6.1399997E11","5.37999999E11","0.0"],["Ecuador","6.9555364E10","7.9276663E10","8.7924548E10","9.4776173E10","1.01000004E11","0.0"],["Venezuela- RB","3.94000007E11","3.1600001E11","3.80999991E11","0.0","0.0","0.0"],["Peru","1.48999995E11","1.71000005E11","1.92999997E11","2.02000007E11","2.03000005E11","0.0"],["Colombia","2.87000003E11","3.35000011E11","3.70000003E11","3.8000001E11","3.78000015E11","0.0"],["Mexico","1.05000003E12","1.17000005E12","1.18000006E12","1.25999999E12","1.29000001E12","0.0"],["Chile","2.17999999E11","2.50999996E11","2.64999993E11","2.76999995E11","2.57999995E11","0.0"]]},"dateCreated":"Jun 26, 2016 5:23:35 PM","dateStarted":"Jun 26, 2016 5:49:35 PM","dateFinished":"Jun 26, 2016 5:49:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:604"},{"text":"%sql \nselect Country_Name,YR2010, YR2011, YR2012, YR2013, YR2014, YR2015\nfrom myCopa\nwhere Series_Code = \"${Series_Code=SE-PRM-CMPT-ZS}\"\n","dateUpdated":"Jun 26, 2016 5:54:54 PM","config":{"colWidth":4,"graph":{"mode":"pieChart","height":382,"optionOpen":false,"keys":[{"name":"Country_Name","index":0,"aggr":"sum"}],"values":[{"name":"YR2010","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Country_Name","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{"maxAge":"35","Series_Code":"SE-PRM-CMPT-ZS"},"forms":{"Series_Code":{"name":"Series_Code","defaultValue":"SE-PRM-CMPT-ZS","hidden":false}}},"jobName":"paragraph_1466961815928_1079542783","id":"20160626-172335_1269962680","result":{"code":"SUCCESS","type":"TABLE","msg":"Country_Name\tYR2010\tYR2011\tYR2012\tYR2013\tYR2014\tYR2015\nUnited States\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\nArgentina\t104.80879\t104.41399\t103.22477\t100.87737\t0.0\t0.0\nEcuador\t100.86143\t107.93887\t111.85759\t112.88042\t112.56042\t0.0\nVenezuela- RB\t92.52151\t93.91329\t95.27824\t95.31894\t96.24232\t0.0\nPeru\t103.35593\t99.77302\t94.00992\t95.14899\t95.90559\t0.0\nColombia\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\nMexico\t92.57442\t92.60792\t98.85065\t102.82186\t0.0\t0.0\nChile\t0.0\t95.823\t97.79994\t96.6214\t0.0\t0.0\n","comment":"","msgTable":[[{"key":"YR2010","value":"United States"},{"key":"YR2010","value":"0.0"},{"key":"YR2010","value":"0.0"},{"key":"YR2010","value":"0.0"},{"key":"YR2010","value":"0.0"},{"key":"YR2010","value":"0.0"},{"key":"YR2010","value":"0.0"}],[{"key":"YR2011","value":"Argentina"},{"key":"YR2011","value":"104.80879"},{"key":"YR2011","value":"104.41399"},{"key":"YR2011","value":"103.22477"},{"key":"YR2011","value":"100.87737"},{"key":"YR2011","value":"0.0"},{"key":"YR2011","value":"0.0"}],[{"key":"YR2012","value":"Ecuador"},{"key":"YR2012","value":"100.86143"},{"key":"YR2012","value":"107.93887"},{"key":"YR2012","value":"111.85759"},{"key":"YR2012","value":"112.88042"},{"key":"YR2012","value":"112.56042"},{"key":"YR2012","value":"0.0"}],[{"key":"YR2013","value":"Venezuela- RB"},{"key":"YR2013","value":"92.52151"},{"key":"YR2013","value":"93.91329"},{"key":"YR2013","value":"95.27824"},{"key":"YR2013","value":"95.31894"},{"key":"YR2013","value":"96.24232"},{"key":"YR2013","value":"0.0"}],[{"key":"YR2014","value":"Peru"},{"key":"YR2014","value":"103.35593"},{"key":"YR2014","value":"99.77302"},{"key":"YR2014","value":"94.00992"},{"key":"YR2014","value":"95.14899"},{"key":"YR2014","value":"95.90559"},{"key":"YR2014","value":"0.0"}],[{"key":"YR2015","value":"Colombia"},{"key":"YR2015","value":"0.0"},{"key":"YR2015","value":"0.0"},{"key":"YR2015","value":"0.0"},{"key":"YR2015","value":"0.0"},{"key":"YR2015","value":"0.0"},{"key":"YR2015","value":"0.0"}],[{"value":"Mexico"},{"value":"92.57442"},{"value":"92.60792"},{"value":"98.85065"},{"value":"102.82186"},{"value":"0.0"},{"value":"0.0"}],[{"value":"Chile"},{"value":"0.0"},{"value":"95.823"},{"value":"97.79994"},{"value":"96.6214"},{"value":"0.0"},{"value":"0.0"}]],"columnNames":[{"name":"Country_Name","index":0,"aggr":"sum"},{"name":"YR2010","index":1,"aggr":"sum"},{"name":"YR2011","index":2,"aggr":"sum"},{"name":"YR2012","index":3,"aggr":"sum"},{"name":"YR2013","index":4,"aggr":"sum"},{"name":"YR2014","index":5,"aggr":"sum"},{"name":"YR2015","index":6,"aggr":"sum"}],"rows":[["United States","0.0","0.0","0.0","0.0","0.0","0.0"],["Argentina","104.80879","104.41399","103.22477","100.87737","0.0","0.0"],["Ecuador","100.86143","107.93887","111.85759","112.88042","112.56042","0.0"],["Venezuela- RB","92.52151","93.91329","95.27824","95.31894","96.24232","0.0"],["Peru","103.35593","99.77302","94.00992","95.14899","95.90559","0.0"],["Colombia","0.0","0.0","0.0","0.0","0.0","0.0"],["Mexico","92.57442","92.60792","98.85065","102.82186","0.0","0.0"],["Chile","0.0","95.823","97.79994","96.6214","0.0","0.0"]]},"dateCreated":"Jun 26, 2016 5:23:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22","dateFinished":"Jun 26, 2016 5:53:46 PM","dateStarted":"Jun 26, 2016 5:53:46 PM","focus":true},{"text":"%sql \nselect Country_Name, YR2014\nfrom myCopa\nwhere Series_Code = \"${Series_Code=SE-PRM-CMPT-ZS}\"","dateUpdated":"Jun 26, 2016 5:57:39 PM","config":{"colWidth":4,"graph":{"mode":"pieChart","height":380,"optionOpen":false,"keys":[{"name":"Country_Name","index":0,"aggr":"sum"}],"values":[{"name":"YR2014","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Country_Name","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{"Series_Code":"IT-CEL-SETS-P2"},"forms":{"Series_Code":{"name":"Series_Code","defaultValue":"SE-PRM-CMPT-ZS","hidden":false}}},"jobName":"paragraph_1466961815928_1079542783","id":"20160626-172335_2141186967","result":{"code":"SUCCESS","type":"TABLE","msg":"Country_Name\tYR2014\nUnited States\t110.20419\nArgentina\t158.79857\nEcuador\t103.89916\nVenezuela- RB\t98.952\nPeru\t103.61066\nColombia\t113.08115\nMexico\t82.22001\nChile\t133.25563\n","comment":"","msgTable":[[{"key":"YR2014","value":"United States"},{"key":"YR2014","value":"110.20419"}],[{"value":"Argentina"},{"value":"158.79857"}],[{"value":"Ecuador"},{"value":"103.89916"}],[{"value":"Venezuela- RB"},{"value":"98.952"}],[{"value":"Peru"},{"value":"103.61066"}],[{"value":"Colombia"},{"value":"113.08115"}],[{"value":"Mexico"},{"value":"82.22001"}],[{"value":"Chile"},{"value":"133.25563"}]],"columnNames":[{"name":"Country_Name","index":0,"aggr":"sum"},{"name":"YR2014","index":1,"aggr":"sum"}],"rows":[["United States","110.20419"],["Argentina","158.79857"],["Ecuador","103.89916"],["Venezuela- RB","98.952"],["Peru","103.61066"],["Colombia","113.08115"],["Mexico","82.22001"],["Chile","133.25563"]]},"dateCreated":"Jun 26, 2016 5:23:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25","dateFinished":"Jun 26, 2016 5:57:46 PM","dateStarted":"Jun 26, 2016 5:57:39 PM","focus":true},{"dateUpdated":"Jun 26, 2016 5:45:00 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466961815928_1079542783","id":"20160626-172335_1374721724","dateCreated":"Jun 26, 2016 5:23:35 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27","dateFinished":"Jun 26, 2016 5:45:12 PM","dateStarted":"Jun 26, 2016 5:45:12 PM","result":{"code":"SUCCESS","type":"TEXT"}}],"name":"Copa America","id":"2BQSRU92W","angularObjects":{"2B44YVSN1":[],"2AJXGMUUJ":[],"2AK8P7CPX":[],"2AM1YV5CU":[],"2AKK3QQXU":[],"2ANGGHHMQ":[]},"config":{"looknfeel":"default"},"info":{}}